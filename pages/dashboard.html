<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FAP Dashboard - Full Page</title>
    <link rel="stylesheet" href="../styles/popup.css" />
    <link rel="stylesheet" href="../styles/dashboard.css" />
    <link rel="stylesheet" href="../styles/timer-icons.css" />
</head>

<body class="fullpage-mode">
    <div class="wrap">
        <header class="top">
            <div class="brand">
                <img src="../assets/icons/icon128.png" alt="FAP Dashboard" />
                <div>
                    <h1>FAP Dashboard</h1>
                    <div class="login-status-indicator" id="loginStatusIndicator">
                        <div class="status-dot" id="statusDot"></div>
                    </div>
                </div>
            </div>
            <div class="top-actions">
                <span id="verBadge" style="opacity: 0.8; margin-right: 8px"></span>
                <div class="theme-toggle" id="themeToggle" title="Chuy·ªÉn Dark/Light mode"></div>

                <button id="btnOpenFAP" title="M·ªü FAP">M·ªü FAP</button>
            </div>
        </header>

        <!-- Login Banner -->
        <div id="loginBanner" class="login-banner" style="display: none">
            <div class="login-banner-content">
                <div class="login-banner-icon">üîê</div>
                <div class="login-banner-text">
                    <strong>C·∫ßn ƒëƒÉng nh·∫≠p FAP</strong>
                    <span>ƒêang s·ª≠ d·ª•ng d·ªØ li·ªáu c≈©. ƒêƒÉng nh·∫≠p ƒë·ªÉ c·∫≠p nh·∫≠t d·ªØ li·ªáu m·ªõi nh·∫•t.</span>
                </div>
                <div class="login-banner-actions">
                    <button id="btnLoginNow" class="login-btn">ƒêƒÉng nh·∫≠p ngay</button>
                    <button id="btnDismissBanner" class="dismiss-btn">√ó</button>
                </div>
            </div>
        </div>

        <nav class="tabs">
            <div class="tab-indicator"></div>
            <button class="active" data-tab="tab-today">H√¥m nay</button>
            <button data-tab="tab-gpa">GPA</button>
            <button data-tab="tab-calc">T√≠nh GPA</button>
            <button data-tab="tab-stats">Th·ªëng k√™</button>
            <button data-tab="tab-att">ƒêi·ªÉm danh</button>
            <button data-tab="tab-schedule">L·ªãch</button>
            <button data-tab="tab-exam">L·ªãch thi</button>
            <button data-tab="tab-bookmark">Bookmark</button>
            <button data-tab="tab-settings">C√†i ƒë·∫∑t</button>
        </nav>

        <!-- Today's Schedule Tab -->
        <section class="tab active" id="tab-today">
            <div class="widgets-container" id="widgetsContainer">
                <!-- Today's Schedule Widget -->
                <div class="widget" data-widget="today-schedule">
                    <div class="widget-header">
                        <div class="widget-title">üìÖ L·ªãch h√¥m nay</div>
                    </div>
                    <div class="widget-content" id="todayClasses">
                        <div class="no-class">ƒêang t·∫£i...</div>
                    </div>
                </div>
            </div>

            <div class="cards">
                <div class="card">
                    <div class="label">GPA (10)</div>
                    <div class="value" id="gpa10Quick">--</div>
                </div>
                <div class="card">
                    <div class="label">% chuy√™n c·∫ßn</div>
                    <div class="value" id="attRateQuick">--</div>
                </div>
            </div>

            <div class="actions">
                <button id="btnQuickRefresh" class="primary">L√†m m·ªõi t·∫•t c·∫£</button>
            </div>
        </section>

        <section class="tab" id="tab-gpa">
            <div class="cards">
                <div class="card">
                    <div class="label">GPA (10)</div>
                    <div class="value" id="gpa10">--</div>
                </div>
                <div class="card">
                    <div class="label">GPA (4)</div>
                    <div class="value" id="gpa4">--</div>
                </div>
                <div class="card">
                    <div class="label">T·ªïng t√≠n ch·ªâ</div>
                    <div class="value" id="credits">--</div>
                </div>
                <div class="card exclude-info">
                    <div class="label">M√¥n lo·∫°i tr·ª´</div>
                    <div class="value" id="excludedCount">0</div>
                    <div class="exclude-detail" id="excludedDetail">Kh√¥ng c√≥ m√¥n n√†o</div>
                </div>
            </div>
            <div class="actions">
                <button id="btnOpenTranscript">Trang Transcript</button>
                <button id="btnCopyGPA">Copy GPA</button>
                <button id="btnResetExcluded">Reset lo·∫°i tr·ª´</button>
                <button id="btnSetDefaultExcluded">M·∫∑c ƒë·ªãnh</button>
                <button id="btnRefreshAll">L√†m m·ªõi</button>
            </div>
            <div class="table">
                <div class="table-head">
                    <div>Danh s√°ch m√¥n</div>
                    <input id="searchCourse" placeholder="T√¨m m√¥n..." />
                </div>
                <table id="tblCourses">
                    <thead>
                        <tr>
                            <th style="width: 40px">üö´</th>
                            <th>Code</th>
                            <th>T√™n m√¥n</th>
                            <th class="r">TC</th>
                            <th class="r">ƒêi·ªÉm</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th style="width: 60px">üìù</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- GPA Calculator Tab -->
        <section class="tab" id="tab-calc">
            <div class="cards">
                <div class="card">
                    <div class="label">GPA hi·ªán t·∫°i (10)</div>
                    <div class="value" id="calcCurrentGPA">--</div>
                </div>
                <div class="card">
                    <div class="label">T·ªïng t√≠n ch·ªâ hi·ªán t·∫°i</div>
                    <div class="value" id="calcCurrentCredits">--</div>
                </div>
                <div class="card">
                    <div class="label">GPA m·ª•c ti√™u</div>
                    <input type="number" id="calcTargetGPA" class="calc-input-large" placeholder="3.5" step="0.1"
                        min="0" max="10" />
                </div>
            </div>
            <div class="calc-form">
                <div class="calc-row">
                    <label class="calc-label">S·ªë t√≠n ch·ªâ m√¥n m·ªõi:</label>
                    <input type="number" id="calcNewCredits" class="calc-input-small" value="3" min="1" max="10" />
                </div>
                <div class="calc-row-result">
                    <label class="calc-label">ƒêi·ªÉm c·∫ßn ƒë·∫°t:</label>
                    <div id="calcResult">--</div>
                </div>
                <div class="calc-actions">
                    <button id="btnCalculateGPA" class="primary">üßÆ T√≠nh to√°n</button>
                    <button id="btnResetCalc">‚Üª Reset</button>
                </div>
            </div>
            <p class="hint" style="margin-top: 12px">üí° C√¥ng c·ª• gi√∫p b·∫°n t√≠nh to√°n c·∫ßn bao nhi√™u ƒëi·ªÉm ƒë·ªÉ ƒë·∫°t GPA m·ª•c
                ti√™u.</p>
        </section>

        <!-- Statistics Tab -->
        <section class="tab" id="tab-stats">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">ƒêi·ªÉm trung b√¨nh</div>
                    <div class="stat-value" id="statAvgGrade">--</div>
                    <div class="stat-detail">Trung b√¨nh c√°c m√¥n ƒë√£ h·ªçc</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">M√¥n ƒëi·ªÉm cao nh·∫•t</div>
                    <div class="stat-value" id="statBestGrade">--</div>
                    <div class="stat-detail" id="statBestCourse">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">M√¥n ƒëi·ªÉm th·∫•p nh·∫•t</div>
                    <div class="stat-value" id="statWorstGrade">--</div>
                    <div class="stat-detail" id="statWorstCourse">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">T·ª∑ l·ªá Pass</div>
                    <div class="stat-value" id="statPassRate">--</div>
                    <div class="stat-detail">M√¥n ƒë·∫°t / t·ªïng m√¥n</div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="gpaChart"></canvas>
            </div>

            <!-- Analytics Dashboard removed -->
        </section>

        <!-- Attendance Tab -->
        <section class="tab" id="tab-att">
            <div class="cards">
                <div class="card">
                    <div class="label">% chuy√™n c·∫ßn</div>
                    <div class="value" id="attRate">--</div>
                </div>
                <div class="card">
                    <div class="label">C√≥ m·∫∑t</div>
                    <div class="value" id="attPresent">--</div>
                </div>
                <div class="card">
                    <div class="label">V·∫Øng / Mu·ªôn</div>
                    <div class="value" id="attAbsentLate">--</div>
                </div>
            </div>
            <div class="actions">
                <button id="btnOpenAttendance">Trang Attendance</button>
                <button class="primary" id="btnRefreshAttendance">L√†m m·ªõi</button>
            </div>
            <div class="table">
                <div class="table-head">
                    <div>Nh·∫≠t k√Ω ƒëi·ªÉm danh (g·∫ßn nh·∫•t ‚Üí xa)</div>
                    <div style="display: flex; gap: 8px; align-items: center">
                        <select id="filterDay">
                            <option value="ALL">T·∫•t c·∫£ ng√†y</option>
                            <option value="MON">Th·ª© 2</option>
                            <option value="TUE">Th·ª© 3</option>
                            <option value="WED">Th·ª© 4</option>
                            <option value="THU">Th·ª© 5</option>
                            <option value="FRI">Th·ª© 6</option>
                            <option value="SAT">Th·ª© 7</option>
                            <option value="SUN">Ch·ªß nh·∫≠t</option>
                        </select>
                        <input id="searchAtt" placeholder="T√¨m theo m√¥n / tr·∫°ng th√°i..." />
                    </div>
                </div>
                <table id="tblAttendance">
                    <thead>
                        <tr>
                            <th>Ng√†y</th>
                            <th>Slot</th>
                            <th>M√¥n</th>
                            <th>Tr·∫°ng th√°i</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section class="tab" id="tab-schedule">
            <div class="actions">
                <button id="btnOpenSchedule">Trang Schedule</button>
                <button class="primary" id="btnRefreshSchedule">L√†m m·ªõi</button>
                <button id="btnExportScheduleICS" class="export-btn">üìÖ Export .ics</button>
            </div>
            <div class="table">
                <div class="table-head">
                    <div>L·ªãch c·∫£ tu·∫ßn</div>
                </div>
                <table id="tblScheduleWeek">
                    <thead>
                        <tr>
                            <th>Th·ª©</th>
                            <th>Slot</th>
                            <th>Gi·ªù</th>
                            <th>M√¥n</th>
                            <th>Ph√≤ng</th>
                            <th>Ghi ch√∫</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section class="tab" id="tab-exam">
            <div class="actions">
                <button id="btnOpenExams">Trang L·ªãch thi</button>
                <button class="primary" id="btnRefreshExams">L√†m m·ªõi</button>
                <button id="btnExportExamICS" class="export-btn">üìù Export .ics</button>
            </div>
            <div class="table">
                <div class="table-head">
                    <div>L·ªãch thi c√°c m√¥n</div>
                    <div style="display: flex; gap: 8px">
                        <select id="filterExamTime">
                            <option value="ALL">T·∫•t c·∫£</option>
                            <option value="THIS_WEEK">Tu·∫ßn n√†y</option>
                            <option value="THIS_MONTH">Th√°ng n√†y</option>
                            <option value="UPCOMING">S·∫Øp t·ªõi</option>
                        </select>
                        <input id="searchExam" placeholder="T√¨m m√¥n thi..." />
                    </div>
                </div>
                <table id="tblExams">
                    <thead>
                        <tr>
                            <th>M√¥n</th>
                            <th>T√™n m√¥n</th>
                            <th>Ng√†y thi</th>
                            <th>Gi·ªù</th>
                            <th>Ph√≤ng</th>
                            <th>H√¨nh th·ª©c</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section class="tab" id="tab-bookmark">
            <div class="table">
                <div class="table-head">
                    <div>Truy c·∫≠p nhanh</div>
                </div>
                <div class="book-grid">
                    <button id="btnOpenLMS">LMS HCM</button>
                    <button id="btnOpenFAP2">FAP</button>
                    <button id="btnOpenIT">IT HCM</button>
                </div>
            </div>
        </section>

        <section class="tab" id="tab-settings">
            <div class="settings-section">
                <h3 class="section-title">üé® Giao di·ªán</h3>
                <div class="form">
                    <div class="row">
                        <span>Theme presets:</span>
                        <div class="theme-presets">
                            <button class="theme-preset" data-theme="blue" style="--preset-color: #60a5fa"
                                title="Blue (Default)"></button>
                            <button class="theme-preset" data-theme="green" style="--preset-color: #10b981"
                                title="Green"></button>
                            <button class="theme-preset" data-theme="purple" style="--preset-color: #a78bfa"
                                title="Purple"></button>
                            <button class="theme-preset" data-theme="pink" style="--preset-color: #f472b6"
                                title="Pink"></button>
                            <button class="theme-preset" data-theme="orange" style="--preset-color: #fb923c"
                                title="Orange"></button>
                            <button class="theme-preset" data-theme="red" style="--preset-color: #ef4444"
                                title="Red"></button>
                        </div>
                    </div>
                    <div class="row">
                        <span>Custom accent color:</span>
                        <input type="color" id="customAccentColor" value="#60a5fa" />
                    </div>
                    <div class="row">
                        <span>Background image:</span>
                        <div class="bg-controls">
                            <input type="file" id="bgImageInput" accept="image/*" style="display: none" />
                            <button id="btnSelectBg" class="secondary">üìÅ Ch·ªçn ·∫£nh</button>
                            <button id="btnRemoveBg" class="secondary">üóëÔ∏è X√≥a</button>
                            <button id="btnPresetBg" class="secondary">üé® Presets</button>
                        </div>
                    </div>
                    <div class="row">
                        <span>Background opacity:</span>
                        <input type="range" id="bgOpacity" min="0" max="100" value="20" />
                        <span id="bgOpacityValue">20%</span>
                    </div>
                    <div class="bg-preview" id="bgPreview"></div>
                </div>
            </div>

            <div class="settings-section">
                <h3 class="section-title">‚öôÔ∏è H·ªá th·ªëng</h3>
                <div class="form">
                    <label class="row">
                        <span>Ch·∫ø ƒë·ªô hi·ªÉn th·ªã</span>
                        <select id="setViewMode">
                            <option value="popup">Popup (m·∫∑c ƒë·ªãnh)</option>
                            <option value="fullpage">Trang m·ªõi (l·ªõn h∆°n)</option>
                        </select>
                    </label>
                    <label class="row">
                        <span>Gi·ªù ho·∫°t ƒë·ªông (hh:mm-hh:mm)</span>
                        <input id="setActiveFrom" value="07:00" />
                        <input id="setActiveTo" value="17:40" />
                    </label>
                    <label class="row">
                        <span>Tr·ªÖ th√¥ng b√°o ng·∫´u nhi√™n (ph√∫t, min-max)</span>
                        <input id="setDelayMin" min="0" type="number" value="10" />
                        <input id="setDelayMax" min="0" type="number" value="30" />
                    </label>
                    <label class="row">
                        <span>T·∫ßn su·∫•t ki·ªÉm tra c·∫≠p nh·∫≠t (ph√∫t)</span>
                        <input id="setPollEvery" min="5" type="number" value="15" />
                    </label>
                    <div class="row">
                        <button class="primary" id="btnSaveSettings">L∆∞u c√†i ƒë·∫∑t</button>
                        <button id="btnTestNotify">Test th√¥ng b√°o</button>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h3 class="section-title">üì§ Export</h3>
                <div class="form">
                    <div class="row">
                        <button id="btnExportPDF">üìÑ Export PDF</button>
                        <button id="btnExportCSV">üìä Export CSV</button>
                    </div>
                </div>
            </div>

            <p class="hint">
                C√†i ƒë·∫∑t n√†y d√πng cho service worker ƒë·ªÉ t·ª± ki·ªÉm tra c·∫≠p nh·∫≠t ƒëi·ªÉm danh v√† nh·∫Øc b·∫°n sau khi h·ªá th·ªëng c·∫≠p
                nh·∫≠t.
            </p>
        </section>

        <!-- Custom Modal System -->
        <div class="modal-overlay" id="modalOverlay">
            <div class="modal-box">
                <div class="modal-icon" id="modalIcon"></div>
                <h3 class="modal-title" id="modalTitle">Th√¥ng b√°o</h3>
                <p class="modal-message" id="modalMessage"></p>
                <div class="modal-actions">
                    <button id="modalConfirm" class="primary">OK</button>
                    <button id="modalCancel" style="display: none">H·ªßy</button>
                </div>
            </div>
        </div>

        <!-- Toast Notifications Container -->
        <div class="toast-container" id="toastContainer"></div>

        <!-- Calendar Modal -->
        <div class="modal-overlay" id="calendarModal" style="display: none">
            <div class="modal-box">
                <div class="modal-icon">üìÖ</div>
                <h3 class="modal-title" id="calendarModalTitle">X√°c nh·∫≠n</h3>
                <p class="modal-message" id="calendarModalMessage">B·∫°n c√≥ mu·ªën ti·∫øp t·ª•c?</p>
                <div class="modal-actions">
                    <button id="calendarModalConfirm" class="primary">X√°c nh·∫≠n</button>
                    <button id="calendarModalCancel">H·ªßy</button>
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div class="modal-overlay" id="calendarHelpModal" style="display: none">
            <div class="modal-box">
                <div class="modal-icon">üìÖ</div>
                <h3 class="modal-title">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h3>
                <div class="modal-message">
                    <p><strong>üìÖ Export Google Calendar</strong></p>

                    <p><strong>üì§ Export .ics:</strong></p>
                    <ol>
                        <li>Nh·∫•p n√∫t "Export .ics"</li>
                        <li>T·∫£i file .ics v·ªÅ m√°y</li>
                        <li>M·ªü Google Calendar ‚Üí Import & Export</li>
                        <li>Ch·ªçn file .ics v√† import</li>
                    </ol>

                    <p><strong>üí° L∆∞u √Ω:</strong></p>
                    <ul>
                        <li>File .ics chu·∫©n RFC 5545</li>
                        <li>T∆∞∆°ng th√≠ch v·ªõi Google Calendar, Outlook, Apple Calendar</li>
                        <li>C√≥ th·ªÉ import nhi·ªÅu l·∫ßn</li>
                        <li>Bao g·ªìm nh·∫Øc nh·ªü t·ª± ƒë·ªông</li>
                    </ul>
                </div>
                <div class="modal-actions">
                    <button id="modalHelpClose" class="primary">ƒê√£ hi·ªÉu</button>
                </div>
            </div>
        </div>

        <script src="../scripts/auto-calendar.js"></script>
        <script src="../assets/vendor/chart.min.js"></script>
        <!-- Core utility modules (load first) -->
        <script src="../scripts/modules/utils.js"></script>
        <script src="../scripts/modules/storage.js"></script>
        <script src="../scripts/modules/api.js"></script>
        <!-- Feature modules -->
        <script src="../scripts/modules/ui.js"></script>
        <script src="../scripts/modules/login.js"></script>
        <script src="../scripts/modules/transcript.js"></script>
        <script src="../scripts/modules/exams.js"></script>
        <script src="../scripts/modules/today-schedule.js"></script>
        <script src="../scripts/modules/settings.js"></script>
        <script src="../scripts/modules/statistics.js"></script>
        <script src="../scripts/modules/theme.js"></script>
        <script src="../scripts/modules/tabs.js"></script>
        <script src="../scripts/modules/gpa-calculator.js"></script>
        <script src="../scripts/modules/advanced-search.js"></script>
        <script src="../scripts/modules/attendance.js"></script>
        <script src="../scripts/modules/study-plans.js"></script>
        <script src="../scripts/modules/update.js"></script>
        <script src="../scripts/modules/calendar.js"></script>
        <!-- Main popup script -->
        <script src="../scripts/popup.js"></script>
    </div>
</body>

</html>