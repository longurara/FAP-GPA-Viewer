<!DOCTYPE html>

<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width,initial-scale=1" name="viewport" />
    <title>FAP Dashboard</title>
    <link href="popup.css" rel="stylesheet" />
    <link href="timer-icons.css" rel="stylesheet" />
  </head>
  <body>
    <!-- SVG Icons -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
      <symbol id="play-icon" viewBox="0 0 24 24">
        <path d="M8 5v14l11-7z" fill="currentColor" />
      </symbol>
      <symbol id="pause-icon" viewBox="0 0 24 24">
        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" fill="currentColor" />
      </symbol>
      <symbol id="reset-icon" viewBox="0 0 24 24">
        <path
          d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
          fill="currentColor"
        />
      </symbol>
      <symbol id="stop-icon" viewBox="0 0 24 24">
        <path d="M6 6h12v12H6z" fill="currentColor" />
      </symbol>
      <symbol id="settings-icon" viewBox="0 0 24 24">
        <path
          d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"
          fill="currentColor"
        />
      </symbol>
      <symbol id="timer-icon" viewBox="0 0 24 24">
        <path
          d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"
          fill="currentColor"
        />
      </symbol>
    </svg>
    <div class="wrap">
      <header class="top">
        <div class="brand">
          <img alt="icon" src="icon128.png" />
          <h1>FAP Dashboard</h1>
        </div>
        <div class="header-controls">
          <div class="login-status-container">
            <div class="login-status" id="loginStatus">
              <div class="login-status-icon" id="loginStatusIcon"></div>
              <div class="login-status-text">
                <div class="login-status-title" id="loginStatusTitle">
                  Ki·ªÉm tra...
                </div>
              </div>
              <div class="login-status-indicator" id="loginStatusIndicator">
                <div class="status-dot" id="statusDot"></div>
              </div>
            </div>
          </div>
          <div class="top-actions">
            <span id="verBadge" style="opacity: 0.8; margin-right: 8px"></span>
            <div
              class="theme-toggle"
              id="themeToggle"
              title="Chuy·ªÉn Dark/Light mode"
            ></div>
            <button id="btnCheckUpdate" title="Ki·ªÉm tra c·∫≠p nh·∫≠t">
              Check update
            </button>
            <button id="btnOpenFAP" title="M·ªü FAP">M·ªü FAP</button>
          </div>
        </div>
      </header>

      <!-- Login Banner -->
      <div id="loginBanner" class="login-banner" style="display: none">
        <div class="login-banner-content">
          <div class="login-banner-icon">üîê</div>
          <div class="login-banner-text">
            <strong>C·∫ßn ƒëƒÉng nh·∫≠p FAP</strong>
            <span
              >ƒêang s·ª≠ d·ª•ng d·ªØ li·ªáu c≈©. ƒêƒÉng nh·∫≠p ƒë·ªÉ c·∫≠p nh·∫≠t d·ªØ li·ªáu m·ªõi
              nh·∫•t.</span
            >
          </div>
          <div class="login-banner-actions">
            <button id="btnLoginNow" class="login-btn">ƒêƒÉng nh·∫≠p ngay</button>
            <button id="btnDismissBanner" class="dismiss-btn">√ó</button>
          </div>
        </div>
      </div>

      <nav class="tabs">
        <div class="tab-indicator"></div>
        <button class="active" data-tab="tab-today">H√¥m nay</button>
        <button data-tab="tab-gpa">GPA</button>
        <button data-tab="tab-calc">T√≠nh GPA</button>
        <button data-tab="tab-stats">Th·ªëng k√™</button>
        <button data-tab="tab-timer">Timer</button>
        <button data-tab="tab-att">ƒêi·ªÉm danh</button>
        <button data-tab="tab-schedule">L·ªãch</button>
        <button data-tab="tab-exam">L·ªãch thi</button>
        <button data-tab="tab-bookmark">Bookmark</button>
        <button data-tab="tab-settings">C√†i ƒë·∫∑t</button>
      </nav>
      <!-- Today's Schedule Tab -->
      <section class="tab active" id="tab-today">
        <div class="widgets-container" id="widgetsContainer">
          <!-- Quick Stats Widget -->
          <div class="widget" data-widget="quick-stats">
            <div class="widget-header">
              <div class="widget-title">üìä Th·ªëng k√™ nhanh</div>
              <div class="widget-controls">
                <button
                  class="widget-btn"
                  data-widget-action="toggle"
                  data-widget-id="quick-stats"
                >
                  ‚àí
                </button>
                <button
                  class="widget-btn"
                  data-widget-action="remove"
                  data-widget-id="quick-stats"
                >
                  √ó
                </button>
              </div>
            </div>
            <div class="widget-content" id="quickStatsContent">
              <div class="stat-row">
                <span>GPA hi·ªán t·∫°i:</span>
                <span id="quickGPA">--</span>
              </div>
              <div class="stat-row">
                <span>ƒêi·ªÉm danh:</span>
                <span id="quickAttendance">--</span>
              </div>
              <div class="stat-row">
                <span>Pomodoros h√¥m nay:</span>
                <span id="quickPomodoros">0</span>
              </div>
            </div>
          </div>

          <!-- Today's Schedule Widget -->
          <div class="widget" data-widget="today-schedule">
            <div class="widget-header">
              <div class="widget-title">üìÖ L·ªãch h√¥m nay</div>
              <div class="widget-controls">
                <button
                  class="widget-btn"
                  data-widget-action="toggle"
                  data-widget-id="today-schedule"
                >
                  ‚àí
                </button>
                <button
                  class="widget-btn"
                  data-widget-action="remove"
                  data-widget-id="today-schedule"
                >
                  √ó
                </button>
              </div>
            </div>
            <div class="widget-content" id="todayClasses">
              <div class="no-class">ƒêang t·∫£i...</div>
            </div>
          </div>

          <!-- Quick Actions Widget -->
          <div class="widget" data-widget="quick-actions">
            <div class="widget-header">
              <div class="widget-title">‚ö° Thao t√°c nhanh</div>
              <div class="widget-controls">
                <button
                  class="widget-btn"
                  data-widget-action="toggle"
                  data-widget-id="quick-actions"
                >
                  ‚àí
                </button>
                <button
                  class="widget-btn"
                  data-widget-action="remove"
                  data-widget-id="quick-actions"
                >
                  √ó
                </button>
              </div>
            </div>
            <div class="widget-content">
              <div class="quick-actions-grid">
                <button
                  class="quick-action-btn"
                  data-tab-action="switch"
                  data-tab-id="tab-timer"
                >
                  <span class="action-icon">‚è±Ô∏è</span>
                  <span class="action-text">Timer</span>
                </button>
                <button
                  class="quick-action-btn"
                  data-tab-action="switch"
                  data-tab-id="tab-calc"
                >
                  <span class="action-icon">üßÆ</span>
                  <span class="action-text">T√≠nh GPA</span>
                </button>
                <button
                  class="quick-action-btn"
                  data-tab-action="switch"
                  data-tab-id="tab-att"
                >
                  <span class="action-icon">üìö</span>
                  <span class="action-text">ƒêi·ªÉm danh</span>
                </button>
                <button
                  class="quick-action-btn"
                  data-tab-action="switch"
                  data-tab-id="tab-exam"
                >
                  <span class="action-icon">üìù</span>
                  <span class="action-text">L·ªãch thi</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Weather Widget -->
          <div class="widget" data-widget="weather">
            <div class="widget-header">
              <div class="widget-title">üå§Ô∏è Th·ªùi ti·∫øt</div>
              <div class="widget-controls">
                <button
                  class="widget-btn"
                  data-widget-action="toggle"
                  data-widget-id="weather"
                >
                  ‚àí
                </button>
                <button
                  class="widget-btn"
                  data-widget-action="remove"
                  data-widget-id="weather"
                >
                  √ó
                </button>
              </div>
            </div>
            <div class="widget-content">
              <div class="weather-info">
                <div class="weather-temp">--¬∞C</div>
                <div class="weather-desc">Kh√¥ng c√≥ d·ªØ li·ªáu</div>
                <div class="weather-location">H·ªì Ch√≠ Minh</div>
              </div>
            </div>
          </div>
        </div>
        <div class="cards">
          <div class="card">
            <div class="label">GPA (10)</div>
            <div class="value" id="gpa10Quick">--</div>
          </div>
          <div class="card">
            <div class="label">% chuy√™n c·∫ßn</div>
            <div class="value" id="attRateQuick">--</div>
          </div>
          <div class="card">
            <div class="label">
              <span class="streak-badge">
                <span class="fire">üî•</span>
                <span id="streakCount">0</span> ng√†y
              </span>
            </div>
            <div class="label" style="font-size: 11px; margin-top: 4px">
              Streak hi·ªán t·∫°i
            </div>
          </div>
        </div>
        <div class="actions">
          <button id="btnQuickRefresh" class="primary">L√†m m·ªõi t·∫•t c·∫£</button>
        </div>
      </section>
      <section class="tab" id="tab-gpa">
        <div class="cards">
          <div class="card">
            <div class="label">GPA (10)</div>
            <div class="value" id="gpa10">--</div>
          </div>
          <div class="card">
            <div class="label">GPA (4)</div>
            <div class="value" id="gpa4">--</div>
          </div>
          <div class="card">
            <div class="label">T·ªïng t√≠n ch·ªâ</div>
            <div class="value" id="credits">--</div>
          </div>
          <div class="card exclude-info">
            <div class="label">M√¥n lo·∫°i tr·ª´</div>
            <div class="value" id="excludedCount">0</div>
            <div class="exclude-detail" id="excludedDetail">
              Kh√¥ng c√≥ m√¥n n√†o
            </div>
          </div>
        </div>
        <div class="actions">
          <button id="btnOpenTranscript">Trang Transcript</button>
          <button id="btnCopyGPA">Copy GPA</button>
          <button id="btnResetExcluded">Reset lo·∫°i tr·ª´</button>
          <button id="btnSetDefaultExcluded">M·∫∑c ƒë·ªãnh</button>
          <button id="btnRefreshAll">L√†m m·ªõi</button>
        </div>
        <div class="table">
          <div class="table-head">
            <div>Danh s√°ch m√¥n</div>
            <input id="searchCourse" placeholder="T√¨m m√¥n..." />
          </div>
          <table id="tblCourses">
            <thead>
              <tr>
                <th style="width: 40px">üö´</th>
                <th>Code</th>
                <th>T√™n m√¥n</th>
                <th class="r">TC</th>
                <th class="r">ƒêi·ªÉm</th>
                <th>Tr·∫°ng th√°i</th>
                <th style="width: 60px">üìù</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
      <!-- GPA Calculator Tab -->
      <section class="tab" id="tab-calc">
        <div class="cards">
          <div class="card">
            <div class="label">GPA hi·ªán t·∫°i (10)</div>
            <div class="value" id="calcCurrentGPA">--</div>
          </div>
          <div class="card">
            <div class="label">T·ªïng t√≠n ch·ªâ hi·ªán t·∫°i</div>
            <div class="value" id="calcCurrentCredits">--</div>
          </div>
          <div class="card">
            <div class="label">GPA m·ª•c ti√™u</div>
            <input
              type="number"
              id="calcTargetGPA"
              class="calc-input-large"
              placeholder="3.5"
              step="0.1"
              min="0"
              max="10"
            />
          </div>
        </div>
        <div class="calc-form">
          <div class="calc-row">
            <label class="calc-label">S·ªë t√≠n ch·ªâ m√¥n m·ªõi:</label>
            <input
              type="number"
              id="calcNewCredits"
              class="calc-input-small"
              value="3"
              min="1"
              max="10"
            />
          </div>
          <div class="calc-row-result">
            <label class="calc-label">ƒêi·ªÉm c·∫ßn ƒë·∫°t:</label>
            <div id="calcResult">--</div>
          </div>
          <div class="calc-actions">
            <button id="btnCalculateGPA" class="primary">üßÆ T√≠nh to√°n</button>
            <button id="btnResetCalc">‚Ü∫ Reset</button>
          </div>
        </div>
        <p class="hint" style="margin-top: 12px">
          üí° C√¥ng c·ª• gi√∫p b·∫°n t√≠nh to√°n c·∫ßn bao nhi√™u ƒëi·ªÉm ƒë·ªÉ ƒë·∫°t GPA m·ª•c ti√™u.
        </p>
      </section>
      <!-- Statistics Tab -->
      <section class="tab" id="tab-stats">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">ƒêi·ªÉm trung b√¨nh</div>
            <div class="stat-value" id="statAvgGrade">--</div>
            <div class="stat-detail">Trung b√¨nh c√°c m√¥n ƒë√£ h·ªçc</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">M√¥n ƒëi·ªÉm cao nh·∫•t</div>
            <div class="stat-value" id="statBestGrade">--</div>
            <div class="stat-detail" id="statBestCourse">--</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">M√¥n ƒëi·ªÉm th·∫•p nh·∫•t</div>
            <div class="stat-value" id="statWorstGrade">--</div>
            <div class="stat-detail" id="statWorstCourse">--</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">T·ª∑ l·ªá Pass</div>
            <div class="stat-value" id="statPassRate">--</div>
            <div class="stat-detail">M√¥n ƒë·∫°t / t·ªïng m√¥n</div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="gpaChart"></canvas>
        </div>

        <!-- Analytics Dashboard -->
        <div class="analytics-section">
          <h3 class="section-title">üìä Analytics Dashboard</h3>
          <div class="analytics-grid">
            <div class="analytics-card">
              <div class="analytics-header">
                <h4>üìà Study Patterns</h4>
                <button
                  class="analytics-btn"
                  data-analytics-action="toggle"
                  data-analytics-id="study-patterns"
                >
                  ‚àí
                </button>
              </div>
              <div class="analytics-content" id="study-patterns">
                <div class="pattern-item">
                  <span class="pattern-label">Peak study time:</span>
                  <span class="pattern-value" id="peakStudyTime">--</span>
                </div>
                <div class="pattern-item">
                  <span class="pattern-label">Average session:</span>
                  <span class="pattern-value" id="avgSession">--</span>
                </div>
                <div class="pattern-item">
                  <span class="pattern-label">Most productive day:</span>
                  <span class="pattern-value" id="productiveDay">--</span>
                </div>
              </div>
            </div>

            <div class="analytics-card">
              <div class="analytics-header">
                <h4>üéØ Productivity Insights</h4>
                <button
                  class="analytics-btn"
                  data-analytics-action="toggle"
                  data-analytics-id="productivity"
                >
                  ‚àí
                </button>
              </div>
              <div class="analytics-content" id="productivity">
                <div class="insight-item">
                  <span class="insight-label">Focus score:</span>
                  <div class="insight-bar">
                    <div
                      class="insight-fill"
                      id="focusScore"
                      style="width: 0%"
                    ></div>
                  </div>
                  <span class="insight-value" id="focusScoreText">0%</span>
                </div>
                <div class="insight-item">
                  <span class="insight-label">Consistency:</span>
                  <div class="insight-bar">
                    <div
                      class="insight-fill"
                      id="consistencyScore"
                      style="width: 0%"
                    ></div>
                  </div>
                  <span class="insight-value" id="consistencyScoreText"
                    >0%</span
                  >
                </div>
                <div class="insight-item">
                  <span class="insight-label">Goal progress:</span>
                  <div class="insight-bar">
                    <div
                      class="insight-fill"
                      id="goalProgress"
                      style="width: 0%"
                    ></div>
                  </div>
                  <span class="insight-value" id="goalProgressText">0%</span>
                </div>
              </div>
            </div>

            <div class="analytics-card">
              <div class="analytics-header">
                <h4>üìÖ Weekly Report</h4>
                <button
                  class="analytics-btn"
                  data-analytics-action="toggle"
                  data-analytics-id="weekly-report"
                >
                  ‚àí
                </button>
              </div>
              <div class="analytics-content" id="weekly-report">
                <div class="report-item">
                  <span class="report-label">Total study time:</span>
                  <span class="report-value" id="weeklyStudyTime">0h 0m</span>
                </div>
                <div class="report-item">
                  <span class="report-label">Pomodoros completed:</span>
                  <span class="report-value" id="weeklyPomodoros">0</span>
                </div>
                <div class="report-item">
                  <span class="report-label">Attendance rate:</span>
                  <span class="report-value" id="weeklyAttendance">--</span>
                </div>
              </div>
            </div>

            <div class="analytics-card">
              <div class="analytics-header">
                <h4>üéØ Goals & Targets</h4>
                <button
                  class="analytics-btn"
                  data-analytics-action="toggle"
                  data-analytics-id="goals"
                >
                  ‚àí
                </button>
              </div>
              <div class="analytics-content" id="goals">
                <div class="goal-item">
                  <div class="goal-header">
                    <span class="goal-title">Daily Study Goal</span>
                    <span class="goal-progress" id="dailyGoalProgress"
                      >0/2h</span
                    >
                  </div>
                  <div class="goal-bar">
                    <div
                      class="goal-fill"
                      id="dailyGoalFill"
                      style="width: 0%"
                    ></div>
                  </div>
                </div>
                <div class="goal-item">
                  <div class="goal-header">
                    <span class="goal-title">Weekly Pomodoros</span>
                    <span class="goal-progress" id="weeklyGoalProgress"
                      >0/20</span
                    >
                  </div>
                  <div class="goal-bar">
                    <div
                      class="goal-fill"
                      id="weeklyGoalFill"
                      style="width: 0%"
                    ></div>
                  </div>
                </div>
                <div class="goal-item">
                  <div class="goal-header">
                    <span class="goal-title">GPA Target</span>
                    <span class="goal-progress" id="gpaGoalProgress"
                      >--/3.5</span
                    >
                  </div>
                  <div class="goal-bar">
                    <div
                      class="goal-fill"
                      id="gpaGoalFill"
                      style="width: 0%"
                    ></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Progress Tracking -->
        <div class="progress-tracking-section">
          <h3 class="section-title">üìà Progress Tracking</h3>
          <div class="progress-grid">
            <div class="progress-card">
              <div class="progress-header">
                <h4>üéØ Study Goals</h4>
                <button
                  class="progress-btn"
                  data-progress-action="toggle"
                  data-progress-id="study-goals"
                >
                  ‚àí
                </button>
              </div>
              <div class="progress-content" id="study-goals">
                <div class="goal-tracker">
                  <div class="goal-item">
                    <div class="goal-info">
                      <span class="goal-name">Daily Study Time</span>
                      <span class="goal-target">2h / 2h</span>
                    </div>
                    <div class="goal-bar">
                      <div
                        class="goal-fill"
                        id="dailyStudyProgress"
                        style="width: 0%"
                      ></div>
                    </div>
                    <div class="goal-percentage" id="dailyStudyPercent">0%</div>
                  </div>
                  <div class="goal-item">
                    <div class="goal-info">
                      <span class="goal-name">Weekly Pomodoros</span>
                      <span class="goal-target">0 / 20</span>
                    </div>
                    <div class="goal-bar">
                      <div
                        class="goal-fill"
                        id="weeklyPomoProgress"
                        style="width: 0%"
                      ></div>
                    </div>
                    <div class="goal-percentage" id="weeklyPomoPercent">0%</div>
                  </div>
                  <div class="goal-item">
                    <div class="goal-info">
                      <span class="goal-name">Monthly GPA</span>
                      <span class="goal-target">-- / 3.5</span>
                    </div>
                    <div class="goal-bar">
                      <div
                        class="goal-fill"
                        id="gpaProgress"
                        style="width: 0%"
                      ></div>
                    </div>
                    <div class="goal-percentage" id="gpaPercent">0%</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="progress-card">
              <div class="progress-header">
                <h4>üìä Study Streak</h4>
                <button
                  class="progress-btn"
                  data-progress-action="toggle"
                  data-progress-id="study-streak"
                >
                  ‚àí
                </button>
              </div>
              <div class="progress-content" id="study-streak">
                <div class="streak-display">
                  <div class="streak-number" id="currentStreak">0</div>
                  <div class="streak-label">ng√†y li√™n ti·∫øp</div>
                  <div class="streak-calendar" id="streakCalendar">
                    <!-- Calendar will be populated by JavaScript -->
                  </div>
                </div>
              </div>
            </div>

            <div class="progress-card">
              <div class="progress-header">
                <h4>üìö Subject Progress</h4>
                <button
                  class="progress-btn"
                  data-progress-action="toggle"
                  data-progress-id="subject-progress"
                >
                  ‚àí
                </button>
              </div>
              <div class="progress-content" id="subject-progress">
                <div class="subject-list" id="subjectList">
                  <!-- Subjects will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="btnRefreshStats" class="primary">L√†m m·ªõi th·ªëng k√™</button>
        </div>
      </section>

      <!-- Study Timer Tab -->
      <section class="tab" id="tab-timer">
        <div class="timer-container">
          <div class="timer-display">
            <div class="timer-time" id="timerDisplay">25:00</div>
            <div class="timer-mode" id="timerMode">Pomodoro</div>
          </div>

          <div class="timer-controls">
            <button id="timerStart" class="timer-btn primary">
              <svg class="timer-icon"><use href="#play-icon"></use></svg>
              <span>B·∫Øt ƒë·∫ßu</span>
            </button>
            <button
              id="timerPause"
              class="timer-btn secondary"
              style="display: none"
            >
              <svg class="timer-icon"><use href="#pause-icon"></use></svg>
              <span>T·∫°m d·ª´ng</span>
            </button>
            <button id="timerReset" class="timer-btn secondary">
              <svg class="timer-icon"><use href="#reset-icon"></use></svg>
              <span>Reset</span>
            </button>
          </div>

          <div class="timer-modes">
            <button class="mode-btn active" data-mode="pomodoro" data-time="25">
              üçÖ Pomodoro (25m)
            </button>
            <button class="mode-btn" data-mode="short" data-time="5">
              ‚òï Ngh·ªâ ng·∫Øn (5m)
            </button>
            <button class="mode-btn" data-mode="long" data-time="15">
              üõãÔ∏è Ngh·ªâ d√†i (15m)
            </button>
            <button class="mode-btn" data-mode="custom" data-time="30">
              ‚öôÔ∏è T√πy ch·ªânh (30m)
            </button>
          </div>

          <div class="timer-stats">
            <div class="stat-item">
              <span class="stat-label">Pomodoros h√¥m nay:</span>
              <span class="stat-value" id="pomodorosToday">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Th·ªùi gian h·ªçc:</span>
              <span class="stat-value" id="studyTimeToday">0h 0m</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Streak:</span>
              <span class="stat-value" id="studyStreak">0 ng√†y</span>
            </div>
          </div>

          <div class="timer-settings">
            <h4>‚öôÔ∏è C√†i ƒë·∫∑t Timer</h4>
            <div class="setting-row">
              <label>Pomodoro (ph√∫t):</label>
              <input
                type="number"
                id="pomodoroTime"
                value="25"
                min="1"
                max="60"
              />
            </div>
            <div class="setting-row">
              <label>Ngh·ªâ ng·∫Øn (ph√∫t):</label>
              <input
                type="number"
                id="shortBreakTime"
                value="5"
                min="1"
                max="30"
              />
            </div>
            <div class="setting-row">
              <label>Ngh·ªâ d√†i (ph√∫t):</label>
              <input
                type="number"
                id="longBreakTime"
                value="15"
                min="1"
                max="60"
              />
            </div>
            <div class="setting-row">
              <label>Auto-start ngh·ªâ:</label>
              <input type="checkbox" id="autoStartBreak" />
            </div>
            <div class="setting-row">
              <label>Th√¥ng b√°o √¢m thanh:</label>
              <input type="checkbox" id="soundNotification" checked />
            </div>
          </div>
        </div>
      </section>

      <section class="tab" id="tab-att">
        <div class="cards">
          <div class="card">
            <div class="label">% chuy√™n c·∫ßn</div>
            <div class="value" id="attRate">--</div>
          </div>
          <div class="card">
            <div class="label">C√≥ m·∫∑t</div>
            <div class="value" id="attPresent">--</div>
          </div>
          <div class="card">
            <div class="label">V·∫Øng / Mu·ªôn</div>
            <div class="value" id="attAbsentLate">--</div>
          </div>
        </div>
        <div class="actions">
          <button id="btnOpenAttendance">Trang Attendance</button>
          <button class="primary" id="btnRefreshAttendance">L√†m m·ªõi</button>
        </div>
        <div class="table">
          <div class="table-head">
            <div>Nh·∫≠t k√Ω ƒëi·ªÉm danh (g·∫ßn nh·∫•t ‚Üí xa)</div>
            <div style="display: flex; gap: 8px; align-items: center">
              <select id="filterDay">
                <option value="ALL">T·∫•t c·∫£ ng√†y</option>
                <option value="MON">Th·ª© 2</option>
                <option value="TUE">Th·ª© 3</option>
                <option value="WED">Th·ª© 4</option>
                <option value="THU">Th·ª© 5</option>
                <option value="FRI">Th·ª© 6</option>
                <option value="SAT">Th·ª© 7</option>
                <option value="SUN">Ch·ªß nh·∫≠t</option>
              </select>
              <input
                id="searchAtt"
                placeholder="T√¨m theo m√¥n / tr·∫°ng th√°i..."
              />
            </div>
          </div>
          <table id="tblAttendance">
            <thead>
              <tr>
                <th>Ng√†y</th>
                <th>Slot</th>
                <th>M√¥n</th>
                <th>Tr·∫°ng th√°i</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
      <section class="tab" id="tab-schedule">
        <div class="actions">
          <button id="btnOpenSchedule">Trang Schedule</button>
          <button class="primary" id="btnRefreshSchedule">L√†m m·ªõi</button>
          <button id="btnExportScheduleICS" class="export-btn">
            üìÖ Export .ics
          </button>
        </div>
        <div class="table">
          <div class="table-head"><div>L·ªãch c·∫£ tu·∫ßn</div></div>
          <table id="tblScheduleWeek">
            <thead>
              <tr>
                <th>Th·ª©</th>
                <th>Slot</th>
                <th>Gi·ªù</th>
                <th>M√¥n</th>
                <th>Ph√≤ng</th>
                <th>Ghi ch√∫</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
      <section class="tab" id="tab-exam">
        <div class="actions">
          <button id="btnOpenExams">Trang L·ªãch thi</button>
          <button class="primary" id="btnRefreshExams">L√†m m·ªõi</button>
          <button id="btnExportExamICS" class="export-btn">
            üìù Export .ics
          </button>
        </div>
        <div class="table">
          <div class="table-head">
            <div>L·ªãch thi c√°c m√¥n</div>
            <div style="display: flex; gap: 8px">
              <select id="filterExamTime">
                <option value="ALL">T·∫•t c·∫£</option>
                <option value="THIS_WEEK">Tu·∫ßn n√†y</option>
                <option value="THIS_MONTH">Th√°ng n√†y</option>
                <option value="UPCOMING">S·∫Øp t·ªõi</option>
              </select>
              <input id="searchExam" placeholder="T√¨m m√¥n thi..." />
            </div>
          </div>
          <table id="tblExams">
            <thead>
              <tr>
                <th>M√¥n</th>
                <th>T√™n m√¥n</th>
                <th>Ng√†y thi</th>
                <th>Gi·ªù</th>
                <th>Ph√≤ng</th>
                <th>H√¨nh th·ª©c</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
      <section class="tab" id="tab-bookmark">
        <div class="table">
          <div class="table-head"><div>Truy c·∫≠p nhanh</div></div>
          <div class="book-grid">
            <button id="btnOpenLMS">LMS HCM</button
            ><button id="btnOpenFAP2">FAP</button
            ><button id="btnOpenIT">IT HCM</button>
          </div>
        </div>
      </section>
      <section class="tab" id="tab-settings">
        <div class="settings-section">
          <h3 class="section-title">üé® Giao di·ªán</h3>
          <div class="form">
            <div class="row">
              <span>Theme presets:</span>
              <div class="theme-presets">
                <button
                  class="theme-preset"
                  data-theme="blue"
                  style="--preset-color: #60a5fa"
                  title="Blue (Default)"
                ></button>
                <button
                  class="theme-preset"
                  data-theme="green"
                  style="--preset-color: #10b981"
                  title="Green"
                ></button>
                <button
                  class="theme-preset"
                  data-theme="purple"
                  style="--preset-color: #a78bfa"
                  title="Purple"
                ></button>
                <button
                  class="theme-preset"
                  data-theme="pink"
                  style="--preset-color: #f472b6"
                  title="Pink"
                ></button>
                <button
                  class="theme-preset"
                  data-theme="orange"
                  style="--preset-color: #fb923c"
                  title="Orange"
                ></button>
                <button
                  class="theme-preset"
                  data-theme="red"
                  style="--preset-color: #ef4444"
                  title="Red"
                ></button>
              </div>
            </div>
            <div class="row">
              <span>Custom accent color:</span>
              <input type="color" id="customAccentColor" value="#60a5fa" />
            </div>
            <div class="row">
              <span>Background image:</span>
              <div class="bg-controls">
                <input
                  type="file"
                  id="bgImageInput"
                  accept="image/*"
                  style="display: none"
                />
                <button id="btnSelectBg" class="secondary">üìÅ Ch·ªçn ·∫£nh</button>
                <button id="btnRemoveBg" class="secondary">üóëÔ∏è X√≥a</button>
                <button id="btnPresetBg" class="secondary">üé® Presets</button>
              </div>
            </div>
            <div class="row">
              <span>Background opacity:</span>
              <input type="range" id="bgOpacity" min="0" max="100" value="20" />
              <span id="bgOpacityValue">20%</span>
            </div>
            <div class="bg-preview" id="bgPreview"></div>
          </div>
        </div>

        <div class="settings-section">
          <h3 class="section-title">‚öôÔ∏è H·ªá th·ªëng</h3>
          <div class="form">
            <label class="row">
              <span>Gi·ªù ho·∫°t ƒë·ªông (hh:mm-hh:mm)</span>
              <input id="setActiveFrom" value="07:00" />
              <input id="setActiveTo" value="17:40" />
            </label>
            <label class="row">
              <span>Tr·ªÖ th√¥ng b√°o ng·∫´u nhi√™n (ph√∫t, min-max)</span>
              <input id="setDelayMin" min="0" type="number" value="10" />
              <input id="setDelayMax" min="0" type="number" value="30" />
            </label>
            <label class="row">
              <span>T·∫ßn su·∫•t ki·ªÉm tra c·∫≠p nh·∫≠t (ph√∫t)</span>
              <input id="setPollEvery" min="5" type="number" value="15" />
            </label>
            <div class="row">
              <button class="primary" id="btnSaveSettings">L∆∞u c√†i ƒë·∫∑t</button>
              <button id="btnTestNotify">Test th√¥ng b√°o</button>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h3 class="section-title">üé® Advanced Customization</h3>
          <div class="form">
            <div class="row">
              <span>Custom CSS:</span>
              <div class="css-editor-container">
                <textarea
                  id="customCSS"
                  placeholder="/* Nh·∫≠p CSS t√πy ch·ªânh c·ªßa b·∫°n */
.example {
  background: red;
  color: white;
}"
                ></textarea>
                <div class="css-controls">
                  <button id="btnApplyCSS" class="primary">Apply CSS</button>
                  <button id="btnResetCSS" class="secondary">Reset</button>
                  <button id="btnPreviewCSS" class="secondary">Preview</button>
                </div>
              </div>
            </div>
            <div class="row">
              <span>Layout Mode:</span>
              <select id="layoutMode">
                <option value="default">Default</option>
                <option value="compact">Compact</option>
                <option value="spacious">Spacious</option>
                <option value="minimal">Minimal</option>
              </select>
            </div>
            <div class="row">
              <span>Widget System:</span>
              <div class="widget-controls">
                <button id="btnToggleWidgets" class="secondary">
                  Toggle Widgets
                </button>
                <button id="btnResetLayout" class="secondary">
                  Reset Layout
                </button>
              </div>
            </div>
            <div class="row">
              <span>Tab Layout:</span>
              <div class="layout-editor">
                <button id="btnEditTabs" class="secondary">‚úèÔ∏è Edit Tabs</button>
                <button id="btnResetTabs" class="secondary">
                  üîÑ Reset Tabs
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-section smart-notifications-section">
          <div class="section-header">
            <div class="section-icon">üîî</div>
            <h3 class="section-title">Smart Notifications</h3>
            <div class="section-subtitle">T√πy ch·ªânh th√¥ng b√°o th√¥ng minh</div>
          </div>

          <div class="smart-notifications-content">
            <!-- Timing Settings -->
            <div class="notification-group">
              <div class="group-title">
                <span class="group-icon">‚è∞</span>
                <span>Th·ªùi gian th√¥ng b√°o</span>
              </div>
              <div class="timing-control">
                <div class="timing-label">
                  <span class="label-text">Th√¥ng b√°o tr∆∞·ªõc l·ªõp</span>
                  <span class="label-desc"
                    >Nh·∫Øc nh·ªü tr∆∞·ªõc khi l·ªõp h·ªçc b·∫Øt ƒë·∫ßu</span
                  >
                </div>
                <div class="timing-input">
                  <input
                    type="number"
                    id="notifyBeforeClass"
                    min="0"
                    max="60"
                    value="15"
                    class="number-input"
                  />
                  <span class="input-unit">ph√∫t</span>
                </div>
              </div>
            </div>

            <!-- Notification Types -->
            <div class="notification-group">
              <div class="group-title">
                <span class="group-icon">üì±</span>
                <span>Lo·∫°i th√¥ng b√°o</span>
              </div>

              <div class="notification-options">
                <div class="notification-option">
                  <div class="option-content">
                    <div class="option-icon">üß†</div>
                    <div class="option-text">
                      <div class="option-title">Smart reminders</div>
                      <div class="option-desc">
                        Nh·∫Øc nh·ªü th√¥ng minh d·ª±a tr√™n l·ªãch h·ªçc
                      </div>
                    </div>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="smartReminders" checked />
                    <span class="toggle-slider"></span>
                  </label>
                </div>

                <div class="notification-option">
                  <div class="option-content">
                    <div class="option-icon">‚òï</div>
                    <div class="option-text">
                      <div class="option-title">Study break reminders</div>
                      <div class="option-desc">
                        Nh·∫Øc nh·ªü ngh·ªâ ng∆°i khi h·ªçc l√¢u
                      </div>
                    </div>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="breakReminders" checked />
                    <span class="toggle-slider"></span>
                  </label>
                </div>

                <div class="notification-option">
                  <div class="option-content">
                    <div class="option-icon">üéØ</div>
                    <div class="option-text">
                      <div class="option-title">Goal progress alerts</div>
                      <div class="option-desc">
                        Th√¥ng b√°o ti·∫øn ƒë·ªô m·ª•c ti√™u h·ªçc t·∫≠p
                      </div>
                    </div>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="goalAlerts" checked />
                    <span class="toggle-slider"></span>
                  </label>
                </div>

                <div class="notification-option">
                  <div class="option-content">
                    <div class="option-icon">üìä</div>
                    <div class="option-text">
                      <div class="option-title">Daily summary</div>
                      <div class="option-desc">
                        T√≥m t·∫Øt ho·∫°t ƒë·ªông h·ªçc t·∫≠p h√†ng ng√†y
                      </div>
                    </div>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="dailySummary" />
                    <span class="toggle-slider"></span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Sound Settings -->
            <div class="notification-group">
              <div class="group-title">
                <span class="group-icon">üîä</span>
                <span>√Çm thanh th√¥ng b√°o</span>
              </div>
              <div class="sound-control">
                <div class="sound-label">
                  <span class="label-text">Notification sound</span>
                  <span class="label-desc">Ch·ªçn √¢m thanh cho th√¥ng b√°o</span>
                </div>
                <select id="notificationSound" class="sound-select">
                  <option value="default">üîî Default</option>
                  <option value="gentle">üå∏ Gentle</option>
                  <option value="energetic">‚ö° Energetic</option>
                  <option value="none">üîá None</option>
                </select>
              </div>
            </div>

            <!-- Test Buttons -->
            <div class="notification-group">
              <div class="group-title">
                <span class="group-icon">üß™</span>
                <span>Ki·ªÉm tra th√¥ng b√°o</span>
              </div>
              <div class="test-buttons">
                <button id="btnTestNotify" class="test-btn primary">
                  <span class="btn-icon">üîî</span>
                  <span>Test th√¥ng b√°o</span>
                </button>
                <button id="btnTestSmartNotify" class="test-btn secondary">
                  <span class="btn-icon">üß†</span>
                  <span>Test Smart Notify</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h3 class="section-title">üì§ Export</h3>
          <div class="form">
            <div class="row">
              <button id="btnExportPDF">üìÑ Export PDF</button>
              <button id="btnExportCSV">üìä Export CSV</button>
            </div>
          </div>
        </div>

        <p class="hint">
          C√†i ƒë·∫∑t n√†y d√πng cho service worker ƒë·ªÉ t·ª± ki·ªÉm tra c·∫≠p nh·∫≠t ƒëi·ªÉm danh
          v√† nh·∫Øc b·∫°n sau khi h·ªá th·ªëng c·∫≠p nh·∫≠t.
        </p>
      </section>
    </div>

    <!-- Custom Modal System -->
    <div class="modal-overlay" id="modalOverlay">
      <div class="modal-box">
        <div class="modal-icon" id="modalIcon"></div>
        <h3 class="modal-title" id="modalTitle">Th√¥ng b√°o</h3>
        <p class="modal-message" id="modalMessage"></p>
        <div class="modal-actions">
          <button id="modalConfirm" class="primary">OK</button>
          <button id="modalCancel" style="display: none">H·ªßy</button>
        </div>
      </div>
    </div>

    <!-- Toast Notifications Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Calendar Modal -->
    <div class="modal-overlay" id="calendarModal" style="display: none">
      <div class="modal-box">
        <div class="modal-icon">üìÖ</div>
        <h3 class="modal-title" id="calendarModalTitle">X√°c nh·∫≠n</h3>
        <p class="modal-message" id="calendarModalMessage">
          B·∫°n c√≥ mu·ªën ti·∫øp t·ª•c?
        </p>
        <div class="modal-actions">
          <button id="calendarModalConfirm" class="primary">X√°c nh·∫≠n</button>
          <button id="calendarModalCancel">H·ªßy</button>
        </div>
      </div>
    </div>

    <!-- Help Modal -->
    <div class="modal-overlay" id="calendarHelpModal" style="display: none">
      <div class="modal-box">
        <div class="modal-icon">üìÖ</div>
        <h3 class="modal-title">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h3>
        <div class="modal-message">
          <p><strong>üìÖ Export Google Calendar</strong></p>

          <p><strong>üì§ Export .ics:</strong></p>
          <ol>
            <li>Nh·∫•p n√∫t "Export .ics"</li>
            <li>T·∫£i file .ics v·ªÅ m√°y</li>
            <li>M·ªü Google Calendar ‚Üí Import & Export</li>
            <li>Ch·ªçn file .ics v√† import</li>
          </ol>

          <p><strong>üí° L∆∞u √Ω:</strong></p>
          <ul>
            <li>File .ics chu·∫©n RFC 5545</li>
            <li>T∆∞∆°ng th√≠ch v·ªõi Google Calendar, Outlook, Apple Calendar</li>
            <li>C√≥ th·ªÉ import nhi·ªÅu l·∫ßn</li>
            <li>Bao g·ªìm nh·∫Øc nh·ªü t·ª± ƒë·ªông</li>
          </ul>
        </div>
        <div class="modal-actions">
          <button id="modalHelpClose" class="primary">ƒê√£ hi·ªÉu</button>
        </div>
      </div>
    </div>

    <script src="auto-calendar.js"></script>
    <script src="chart.min.js"></script>
    <script src="popup.js"></script>
  </body>
</html>
